{"version":3,"sources":["pages/Login/Login.module.css","pages/Login/Login.js"],"names":["module","exports","Login","user","useContext","UserContext","client","ClientContext","cache","useQueryCache","login","isLoading","isLoadingLogin","useMutation","name","loginUser","onMutate","cancelQueries","userQuery","snapshot","getQueryData","setQueryData","onError","onSettled","invalidateQueries","logout","isLoadingLogout","logoutUser","onLogout","e","preventDefault","isPending","className","cs","content","form","onSubmit","data","FormData","target","get","required","autoFocus","disabled","type","placeholder","defaultValue","undefined","onClick","value"],"mappings":"oGACAA,EAAOC,QAAU,CAAC,QAAU,uBAAuB,KAAO,sB,iGCoF3CC,UA3ED,KACZ,IAAMC,EAAOC,qBAAWC,KAClBC,EAASF,qBAAWG,KACpBC,EAAQC,eACPC,GAASC,UAAWC,IAAoBC,aAC5CC,GAASR,EAAOS,UAAUD,IAC3B,CACEE,SAAWF,IACTN,EAAMS,cAAcC,KACpB,IAAMC,EAAWX,EAAMY,aAAaF,KAEpC,OADAV,EAAMa,aAAaH,IAAWJ,GACvB,IAAMN,EAAMa,aAAaH,IAAWC,IAE7CG,YACAC,UAAW,KACTf,EAAMgB,kBAAkBN,SASvBO,GAAUd,UAAWe,IAAqBb,aAC/C,IAAMP,EAAOqB,cACb,CACEX,SAAU,KACRR,EAAMS,cAAcC,KACpB,IAAMC,EAAWX,EAAMY,aAAaF,KAEpC,OADAV,EAAMa,aAAaH,IAAW,MACvB,IAAMV,EAAMa,aAAaH,IAAWC,IAE7CG,YACAC,UAAW,KACTf,EAAMgB,kBAAkBN,QAIxBU,EAAQ,8BAAG,UAAOC,GACtBA,EAAEC,iBACFL,OAFY,sDAIRM,EAAYnB,GAAkBc,EACpC,OACE,0BAASM,UAAWC,IAAGC,QAAvB,UACE,6BAAK/B,EAAO,4CAAOA,KAAW,2DAC9B,uBAAM6B,UAAWC,IAAGE,KAAMC,SA5BbP,IACfA,EAAEC,iBACF,IAAMO,EAAO,IAAIC,SAAST,EAAEU,QAC5B7B,EAAM2B,EAAKG,IAAI,cAyBb,UACE,uBACEC,UAAQ,EACRC,WAAS,EACTC,SAAUZ,EACVa,KAAK,OACLC,YAAY,WACZC,aAAc3C,QAAQ4C,EACtBjC,KAAK,aAENX,EACC,uBACEwC,SAAUZ,EACViB,QAASpB,EACTgB,KAAK,SACLK,MAAM,WAEN,KACJ,uBACEN,SAAUZ,EACVa,KAAK,SACLK,MAAO9C,EAAO,SAAW","file":"static/js/6.a87cfa8e.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"content\":\"Login_content__2LJnc\",\"form\":\"Login_form__3bufY\"};","import { useContext } from \"react\";\nimport {\n  ClientContext,\n  UserContext,\n  userQuery,\n  onError,\n} from \"../../constants\";\nimport cs from \"./Login.module.css\";\nimport { useMutation, useQueryCache } from \"react-query\";\n\nconst Login = () => {\n  const user = useContext(UserContext);\n  const client = useContext(ClientContext);\n  const cache = useQueryCache();\n  const [login, { isLoading: isLoadingLogin }] = useMutation(\n    (name) => client.loginUser(name),\n    {\n      onMutate: (name) => {\n        cache.cancelQueries(userQuery);\n        const snapshot = cache.getQueryData(userQuery);\n        cache.setQueryData(userQuery, name);\n        return () => cache.setQueryData(userQuery, snapshot);\n      },\n      onError,\n      onSettled: () => {\n        cache.invalidateQueries(userQuery);\n      },\n    }\n  );\n  const onLogin = (e) => {\n    e.preventDefault();\n    const data = new FormData(e.target);\n    login(data.get(\"username\"));\n  };\n  const [logout, { isLoading: isLoadingLogout }] = useMutation(\n    () => client.logoutUser(),\n    {\n      onMutate: () => {\n        cache.cancelQueries(userQuery);\n        const snapshot = cache.getQueryData(userQuery);\n        cache.setQueryData(userQuery, null);\n        return () => cache.setQueryData(userQuery, snapshot);\n      },\n      onError,\n      onSettled: () => {\n        cache.invalidateQueries(userQuery);\n      },\n    }\n  );\n  const onLogout = async (e) => {\n    e.preventDefault();\n    logout();\n  };\n  const isPending = isLoadingLogin || isLoadingLogout;\n  return (\n    <section className={cs.content}>\n      <h1>{user ? <>Hi, {user}</> : <>What's your name?</>}</h1>\n      <form className={cs.form} onSubmit={onLogin}>\n        <input\n          required\n          autoFocus\n          disabled={isPending}\n          type=\"text\"\n          placeholder=\"username\"\n          defaultValue={user || undefined}\n          name=\"username\"\n        />\n        {user ? (\n          <input\n            disabled={isPending}\n            onClick={onLogout}\n            type=\"button\"\n            value=\"logout\"\n          />\n        ) : null}\n        <input\n          disabled={isPending}\n          type=\"submit\"\n          value={user ? \"change\" : \"login\"}\n        />\n      </form>\n    </section>\n  );\n};\n\nexport default Login;\n"],"sourceRoot":""}